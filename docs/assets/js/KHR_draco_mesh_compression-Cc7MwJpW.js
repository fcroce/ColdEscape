import{ay as h,a6 as y,a7 as E,c as o}from"./index-Curn0qvy.js";import{G as K,A as O}from"./glTFLoader-By7KYH5z.js";import"./glTFLoaderAnimation-CuW2wpvm.js";const c="KHR_draco_mesh_compression";class A{constructor(s){this.name=c,this.useNormalizedFlagFromAccessor=!0,this._loader=s,this.enabled=h.DecoderAvailable&&this._loader.isExtensionUsed(c)}dispose(){delete this.dracoCompression,this._loader=null}_loadVertexDataAsync(s,r,t){return K.LoadExtensionAsync(s,r,this.name,(T,f)=>{if(r.mode!=null&&r.mode!==4&&r.mode!==5)throw new Error(`${s}: Unsupported mode ${r.mode}`);const _={},m={},e=(d,a)=>{const i=f.attributes[d];if(i!=null&&(t._delayInfo=t._delayInfo||[],t._delayInfo.indexOf(a)===-1&&t._delayInfo.push(a),_[a]=i,this.useNormalizedFlagFromAccessor)){const u=O.TryGet(this._loader.gltf.accessors,r.attributes[d]);u&&(m[a]=u.normalized||!1)}};e("POSITION",o.PositionKind),e("NORMAL",o.NormalKind),e("TANGENT",o.TangentKind),e("TEXCOORD_0",o.UVKind),e("TEXCOORD_1",o.UV2Kind),e("TEXCOORD_2",o.UV3Kind),e("TEXCOORD_3",o.UV4Kind),e("TEXCOORD_4",o.UV5Kind),e("TEXCOORD_5",o.UV6Kind),e("JOINTS_0",o.MatricesIndicesKind),e("WEIGHTS_0",o.MatricesWeightsKind),e("COLOR_0",o.ColorKind);const n=O.Get(T,this._loader.gltf.bufferViews,f.bufferView);return n._dracoBabylonGeometry||(n._dracoBabylonGeometry=this._loader.loadBufferViewAsync(`/bufferViews/${n.index}`,n).then(d=>(this.dracoCompression||h.Default)._decodeMeshToGeometryForGltfAsync(t.name,this._loader.babylonScene,d,_,m).catch(i=>{throw new Error(`${s}: ${i.message}`)}))),n._dracoBabylonGeometry})}}y(c);E(c,!0,l=>new A(l));export{A as KHR_draco_mesh_compression};
